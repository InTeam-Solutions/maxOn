# maxOn mini-app · отчёт по первому этапу

## Что сделано
- Настроен отдельный сервис `services/mini-app` на React 18 + Vite + TypeScript с Docker-сборкой и темой MAX (токены, тёмная палитра, шрифты Inter, утилиты).
- Реализован shell-приложения: верхний бар с логотипом, табы (Сегодня, Календарь, Цели, Лидерборд), адаптивная компоновка контента и чата (колонка на desktop, bottom-sheet на mobile).
- Добавлены основные разделы:
  - **Сегодня**: мини-календарь на 7 дней, статистика, карточки задач “Сегодня позже” и “Ближайшие 3 дня”, CTA «+ Цель», ввод сообщения, связка с чатом.
  - **Календарь**: месячный календарь с маркерами задач, повестка выбранной даты, быстрые действия (готово, перейти к цели, обсудить с maxOn).
  - **Цели**: список карточек с прогрессом, экран цели с прогресс-баром и чек-листом подзадач, кнопка “Обсудить с maxOn”.
  - **Лидерборд**: мок-лист пользователей со streak-днями и динамикой.
- Написаны сервисы/контексты: `AppStateContext` (табы, выбранная дата/цель, состояние чата, initData), `ChatContext` + `chatService` с заглушками ответов, мок-данные целей/задач/лидерборда.

## Как ведёт себя
- Навигация по табам мгновенно переключает контент, при клике на задачу из “Сегодня” открывается вкладка “Цели” с нужной целью.
- Чат: сообщения пользователя появляются сразу, через задержку отдаётся мок-ответ maxOn; поддерживается отображение карточек задач/целей, на mobile чат открывается отдельным bottom-sheet.
- Отображение разделов:
  - Сегодня — список задач с цветными бейджами, мини-календарь реагирует на выбор дня.
  - Календарь — стрелки листают месяцы, клики по дням меняют повестку, кнопки “Готово/Вернуть”, переход к цели, запуск чата с контекстом задачи.
  - Цели — карточки с прогрессом, детальный экран позволяет отмечать чек-лист, отправлять контекст в чат.
  - Лидерборд — ранги, streak-дни и позитив/негатив дельта.

## Интеграция с MAX
- `max-web-app.js` подгружается лениво через `ensureMaxWebApp` (src/integrations/maxWebApp.ts) с URL из `VITE_MAX_WEB_APP_SRC` (`.env.example` добавлен).
- После загрузки SDK вызывается `ready()` и `initDataUnsafe` сохраняется в `AppStateContext`, что открывает точку для дальнейшей авторизации / API-вызовов.
- Контекст доступен во всех компонентах, поэтому дальнейшее чтение user/auth-данных прозрачно.

## Что дальше
1. Подключить реальные API (цели, задачи, чат) и заменить мок-сервисы на RTK Query/React Query + серверные схемы.
2. Добавить стейт-менеджмент для модификаций (создание целей, изменение прогресса, отметки задач) и синхронизацию с backend.
3. Доработать чат: поток сообщений от real backend, сохранение истории, контекстные команды/quick actions.
4. Подготовить тестовое покрытие (unit + визуальные снимки важных компонентов) и базовые e2e.

