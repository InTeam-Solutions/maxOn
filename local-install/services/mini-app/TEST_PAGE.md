# –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ MaxOn Mini-App

## üîó URLs

### –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
- Production: `https://mini-2a3lrea9p-0stg0ts-projects.vercel.app`
- Local: `http://localhost:5173`

### –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞:
- Production: `https://mini-8p7bip7du-0stg0ts-projects.vercel.app/test.html`
- Local: `http://localhost:5173/test.html`

## üß™ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä (–±–µ–∑ MAX messenger)

–ü—Ä–æ—Å—Ç–æ –æ—Ç–∫—Ä–æ–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
https://mini-8p7bip7du-0stg0ts-projects.vercel.app/test.html
```

**–ß—Ç–æ –ø–æ–∫–∞–∂–µ—Ç:**
- ‚ùå MAX WebApp SDK –Ω–µ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω (–Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞)
- ‚úÖ –ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω Demo User ID: `89578356`
- ‚úÖ –ú–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å API –∑–∞–ø—Ä–æ—Å—ã –∫ –±—ç–∫–µ–Ω–¥—É

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
1. **–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ü–µ–ª–∏** - GET –∑–∞–ø—Ä–æ—Å –∫ `http://localhost:8104/api/goals?user_id=89578356`
2. **–ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ–±—ã—Ç–∏—è** - GET –∑–∞–ø—Ä–æ—Å –∫ `http://localhost:8104/api/events?user_id=89578356`
3. **–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ** - POST –∑–∞–ø—Ä–æ—Å –∫ `http://localhost:8101/api/process`

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ MAX messenger (—Ä–µ–∞–ª—å–Ω—ã–π user_id)

–î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å WebApp:

1. –û—Ç–∫—Ä–æ–π MAX messenger
2. –ù–∞–π–¥–∏ **@MasterBot**
3. –û—Ç–ø—Ä–∞–≤—å: `/mybots`
4. –í—ã–±–µ—Ä–∏ **@t623_hakaton_bot**
5. –û—Ç–ø—Ä–∞–≤—å: `/setwebapp`
6. –í–≤–µ–¥–∏ URL: `https://mini-8p7bip7du-0stg0ts-projects.vercel.app/test.html`
7. –û—Ç–∫—Ä–æ–π –±–æ—Ç–∞ –∏ –∑–∞–ø—É—Å—Ç–∏ WebApp

**–ß—Ç–æ –ø–æ–∫–∞–∂–µ—Ç:**
- ‚úÖ MAX WebApp SDK –∑–∞–≥—Ä—É–∂–µ–Ω
- ‚úÖ –¢–≤–æ–π —Ä–µ–∞–ª—å–Ω—ã–π User ID –∏–∑ MAX
- ‚úÖ –¢–≤–æ–µ –∏–º—è, username –∏–∑ MAX profile
- ‚úÖ API –∑–∞–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–≤–æ–π user_id

## üìä –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞

### 1. MAX WebApp Info
- –°—Ç–∞—Ç—É—Å SDK (–∑–∞–≥—Ä—É–∂–µ–Ω/–Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω)
- –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ (ios/android/web)
- –í–µ—Ä—Å–∏—è SDK
- –°–æ—Å—Ç–æ—è–Ω–∏–µ (expanded/collapsed)

### 2. User Info
- User ID (–∏–∑ MAX –∏–ª–∏ demo)
- –ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è
- Username
- –Ø–∑—ã–∫

### 3. API Requests
–¢—Ä–∏ –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API:

#### –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ü–µ–ª–∏
```javascript
GET http://localhost:8104/api/goals?user_id={userId}
```
–ü–æ–∫–∞–∂–µ—Ç –≤—Å–µ —Ü–µ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —à–∞–≥–∞–º–∏ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º.

#### –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ–±—ã—Ç–∏—è
```javascript
GET http://localhost:8104/api/events?user_id={userId}
```
–ü–æ–∫–∞–∂–µ—Ç –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

#### –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
```javascript
POST http://localhost:8101/api/process
Body: {
  "user_id": "{userId}",
  "message": "–ü–æ–∫–∞–∂–∏ –º–æ–∏ —Ü–µ–ª–∏",
  "context": {}
}
```
–û—Ç–ø—Ä–∞–≤–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ orchestrator –∏ –ø–æ–∫–∞–∂–µ—Ç –æ—Ç–≤–µ—Ç LLM.

### 4. Raw Data (Debug)
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π `initDataUnsafe` –æ–±—ä–µ–∫—Ç –æ—Ç MAX WebApp SDK –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ.

## üîß –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –ó–∞–ø—É—Å—Ç–∏ –±—ç–∫–µ–Ω–¥:
```bash
cd /Users/asgatakmaev/Desktop/business/maxOn
docker compose up -d
```

2. –ó–∞–ø—É—Å—Ç–∏ mini-app –ª–æ–∫–∞–ª—å–Ω–æ:
```bash
cd services/mini-app
npm run dev
```

3. –û—Ç–∫—Ä–æ–π —Ç–µ—Å—Ç–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É:
```
http://localhost:5173/test.html
```

4. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ:
   - Core API –¥–æ—Å—Ç—É–ø–µ–Ω: http://localhost:8104/docs
   - Orchestrator –¥–æ—Å—Ç—É–ø–µ–Ω: http://localhost:8101/docs

## üêõ Troubleshooting

### API –∑–∞–ø—Ä–æ—Å—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç

**–û—à–∏–±–∫–∞:** `Failed to fetch` –∏–ª–∏ CORS error

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Å—å —á—Ç–æ –±—ç–∫–µ–Ω–¥ –∑–∞–ø—É—â–µ–Ω:
   ```bash
   docker compose ps
   ```

2. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Å–µ—Ä–≤–∏—Å—ã –¥–æ—Å—Ç—É–ø–Ω—ã:
   ```bash
   curl http://localhost:8104/api/goals?user_id=89578356
   curl http://localhost:8101/health
   ```

3. –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å production URL (`mini-8p7bip7du-0stg0ts-projects.vercel.app`):
   - API –Ω–∞ localhost –Ω–µ –¥–æ—Å—Ç—É–ø–Ω—ã –∏–∑ Vercel
   - –ù—É–∂–Ω–æ –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å –±—ç–∫–µ–Ω–¥ –Ω–∞ –ø—É–±–ª–∏—á–Ω—ã–π URL
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ngrok –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

### MAX WebApp SDK –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

**–í –±—Ä–∞—É–∑–µ—Ä–µ:** –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, SDK —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ MAX messenger.

**–í MAX messenger:**
1. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ URL –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ @MasterBot
2. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å HTTPS (Vercel –¥–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
3. –û—Ç–∫—Ä–æ–π Developer Tools –∏ –ø—Ä–æ–≤–µ—Ä—å Console –Ω–∞ –æ—à–∏–±–∫–∏

## üìù –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### CURL –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API:

```bash
# –ü–æ–ª—É—á–∏—Ç—å —Ü–µ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
curl "http://localhost:8104/api/goals?user_id=89578356"

# –ü–æ–ª—É—á–∏—Ç—å —Å–æ–±—ã—Ç–∏—è
curl "http://localhost:8104/api/events?user_id=89578356"

# –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç
curl -X POST "http://localhost:8101/api/process" \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "89578356",
    "message": "–ü–æ–∫–∞–∂–∏ –º–æ–∏ —Ü–µ–ª–∏",
    "context": {}
  }'

# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Ü–µ–ª—å
curl -X POST "http://localhost:8104/api/goals" \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "89578356",
    "title": "–í—ã—É—á–∏—Ç—å Python",
    "description": "–ü—Ä–æ–π—Ç–∏ –∫—É—Ä—Å –ø–æ Python",
    "target_date": "2025-12-31",
    "category": "–û–±—É—á–µ–Ω–∏–µ",
    "priority": "high"
  }'
```

## üöÄ Production deployment

–ö–æ–≥–¥–∞ –±—ç–∫–µ–Ω–¥ –±—É–¥–µ—Ç –Ω–∞ production, –æ–±–Ω–æ–≤–∏ URL –≤ `test.html`:

```javascript
const CORE_API_URL = 'https://your-backend.com:8104';
const ORCHESTRATOR_API_URL = 'https://your-backend.com:8101';
```

–ó–∞—Ç–µ–º –∑–∞–¥–µ–ø–ª–æ–π:
```bash
cd services/mini-app
vercel --prod --yes
```

## üìñ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

- –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [DEPLOY.md](./DEPLOY.md)
- WebApp —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: [/WEBAPP_REGISTRATION.md](../../WEBAPP_REGISTRATION.md)
- Vercel Dashboard: https://vercel.com/0stg0ts-projects/mini-app
